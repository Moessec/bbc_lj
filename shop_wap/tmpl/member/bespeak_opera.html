<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,minimum-scale=1" />
    <title>报修预约</title>
    <link rel="stylesheet" type="text/css" href="../../css/base.css">
    <link rel="stylesheet" type="text/css" href="../../css/nctouch_member.css">
    <link rel="stylesheet" type="text/css" href="../../css/nctouch_common.css">
    <style type="text/css">
        .nctouch-inp-con ul li .input-box .inp {
            width: 89%;
        }
        textarea{width: 95%;margin: auto;background: #F5F5F5; border-style: none;padding:5px 5px  0px 5px; line-height: 20px; color: #2F4F4F;height: 150px;}
        option{ color: #2F4F4F; font-size: 0.6rem}
        #area li{height:33px;line-height:33px;font-size: 0.6rem;color: #000;text-align: center;}
    </style>
</head>

<body>
    <div class="inp" name="area" id="area" autocomplete="off" style=" position:fixed;background: #fff; margin-top:15%; margin-left:25%;display: none; width:50%;" placeholder="请选择项目所在区域" > 
        <li data-flag="0" style="font-size: 0.5rem;line-height: 1.2rem;text-align: center;background: #EEE;">请选择社区</li>
            </div>
    <div id="hei" style="background: #000;opacity: 0.4;display:none;width:100%;height:100%; position:fixed;" ></div>
    <header id="header">
        <div class="header-wrap">
            <div class="header-l">
                <a href="bespeak_list.html"> <i class="back"></i> </a>
            </div>
            <div class="header-title">
                <h1>预约报修</h1>
            </div>
            <div class="header-r"> <a id="header-nav" href="javascript:void(0);"></a> </div>
        </div>
    </header>
            
    <div class="nctouch-main-layout">
        <form>
            <img src="../../images/wap.jpg" style="width:100%">
            <div class="nctouch-inp-con">
                <ul class="form-box">
                    <li class="form-item">
                        <h4>报修项目</h4>
                        <div class="input-box">
                            <select class="inp" name="bespeak_place" id="bespeak_place" autocomplete="off" placeholder="请选择项目所在区域" > 
                            <option value="1">公共区域</option>
                            <option value="0">室内</option> 
                            </select>
                            <span class="input-del"></span>
                        </div>
                    </li>
                    <li class="form-item">
                        <h4>联&nbsp;系&nbsp;人&nbsp;</h4>
                        <div class="input-box">
                            <input type="text" class="inp" name="true_name" id="true_name" autocomplete="off" oninput="writeClear($(this));"  placeholder="请填写您的名字" />
                            <span class="input-del"></span> </div>
                    </li>
                    <li class="form-item">
                        <h4>联系方式</h4>
                        <div class="input-box">
                            <input type="tel" class="inp" name="usercontact" id="usercontact" autocomplete="off" oninput="writeClear($(this));" placeholder="请填写您的联系方式" />
                            <span class="input-del"></span> </div>
                    </li>
                    <li class="form-item">
                        <h4>社区选择</h4>
                        <div class="input-box">
                        <a style="display:block;width: 90%;height: 1.4rem;padding: 0;margin: 8px 5%;font-size: 0.8rem;line-height: 1.5rem;text-align: center;background: #EEE;border: none;border-radius: 0.2rem;" id="btn2" onclick="div2Show()" href="#">选择社区</a>
                        <input type="hidden" name="area_info" id="area_info"/>
                        </div>
                    </li>
                    <li class="form-item">
                        <h4>详细地址</h4>
                        <div class="input-box">
                            <input type="text" class="inp" name="address" id="address" autocomplete="off" oninput="writeClear($(this));"  placeholder="所在位置">
                            <span class="input-del"></span> </div>
                    </li>
                    <li class="form-item">
                        <h4>上门时间</h4>
                        <div class="input-box" style="float:right">
                            <select name="h" id="h" onchange="show();">
                            <script>
                            for(var i=0;i<=23;i++){
                             document.write("<option value='"+i+"'>"+i+"：00</option>");
                            }
                            </script>
                            </select>
                            <span style="font-size: 0.6rem;">-</span>
                            <select name="min" id="min" onchange="show();">
                            <script>
                            for(var i=0;i<=23;i++){
                             document.write("<option value='"+i+"'>"+i+"：00</option>");
                            }
                            </script>
                            </select>
                            <input type="hidden" class="inp" name="starttime" id="starttime" autocomplete="off" oninput="writeClear($(this));" />
                            <span class="input-del"></span>

                        </div>
                    </li>
                    <li class="form-item">
                        <textarea type="tel" class="inp" name="bespeak_com" id="bespeak_com" autocomplete="off" oninput="writeClear($(this));" style="h" placeholder="简单描述你需要申报的项目" /></textarea>
                        <span class="input-del"></span>
                    </li>
                    <li class="form-item">
                      <style>
                        .txt{ height:28px; border:1px solid #cdcdcd; width:670px;    font-size: 1rem;margin-left: 40px}
                        .mybtn{ background-color:#FFF; line-height:14px;vertical-align:middle;border:1px solid #CDCDCD;height:30px; width:70px;    font-size: 1rem;margin-left: 40px}
                        .file{ position:absolute; top:0;    font-size: 0.6rem; right:80px; height:24px; filter:alpha(opacity:0);opacity: 0;width:260px }
                        </style>
                        <div class="form-group" style="margin-top:10px">
                            <input type="file" name="file" class="file" id="file" size="28"  onchange="preImg(this.id,'imgPre');UpladFile();" />
                            <!-- <span onclick="UpladFile()" id="upload" style="font-size: 0.6rem;" class="mybtn">上传</span> -->
                            <div class="input-box" style="display:none">
                                <input type="tel" class="inp" name="img" id="img" autocomplete="off" oninput="writeClear($(this));" />
                                <span class="input-del"></span>
                            </div>
                            <img id="imgPre" onclick="file.click()" src="../../images/Snap11.jpg" width="30%" height="25%" style="display: block;margin: auto;">
                        </div>
                        <span style="font-size: 0.6rem;color: #cccccc;margin: auto;padding-top: 5px;display: block;width: 50%;text-align: center;">您需要上传维修部分的图片</span>
                        <span class="input-del"></span>
                  </li>
                </ul>
                <div class="error-tips"></div>
                <div class="form-btn"><a style="margin-bottom:15px"  class="btn" href="javascript:;">申请报修</a></div>
            </div>
        </form>
    </div>
    <script type="text/javascript">
    var btn2 =document.getElementById('btn2');
    var are = document.getElementById("area");
    var ops = area.getElementsByTagName("li");
    var hei = document.getElementById("hei");
    function div2Show() {
        are.style.display = "block";
        hei.style.display = "block";
        are.style.zIndex = 999999;
        hei.style.zIndex = 999998;
        areainfo();
    }
    function areainfo() {
        var area = document.getElementById("area");
        var ops = area.getElementsByTagName("li");
        var arrOps = Array.prototype.slice.call(ops, 0);
        arrOps.sort(function (a, b) {
            return a.attributes["data-flag"].value - b.attributes["data-flag"].value;
        });
        arrOps.map(function (op) {
            area.appendChild(op);
        });
    }
    ops.onclick = function (ccc){
        var info = document.getElementById("area_info");
        alert(document.getElementById("area_info"))
        document.getElementById(ccc.target.attributes["data-flag"].value).value=ccc.target.attributes["data-flag"].value;
        info.style.display = "none";
        hei.style.display = "none";
    }
    function show(){
     document.getElementById("starttime").value=document.getElementById("h").value+":00-"+document.getElementById("min").value+":00";
    }
    var xhr;
    function createXMLHttpRequest()
    {
        if(window.ActiveXObject)
        {
            xhr = new ActiveXObject("Microsoft.XMLHTTP");
        }
        else if(window.XMLHttpRequest)
        {
            xhr = new XMLHttpRequest();
        }
    }
    function UpladFile()
    {
        var fileObj = document.getElementById("file").files[0];
        var FileController = ApiUrl + "/index.php?ctl=Buyer_Bespeak&met=upload&typ=json";
        var form = new FormData();
        form.append("myfile", fileObj);
        createXMLHttpRequest();
        xhr.onreadystatechange = handleStateChange;
        xhr.open("post", FileController, true);
        xhr.send(form);
    }
    function handleStateChange()
    {
        if(xhr.readyState == 4)
        {
            if (xhr.status == 200 || xhr.status == 0)
            {
                var result = xhr.responseText;
                var json = eval("(" + result + ")");
                var img = document.getElementById('img');
                var val = img.value
                img.value=json.file+val;
                alert("上传成功");
            }
        }
    }

    function getFileUrl(sourceId) { 
    var url; 
    if (navigator.userAgent.indexOf("MSIE")>=1) { // IE 
    url = document.getElementById(sourceId).value; 
    } else if(navigator.userAgent.indexOf("Firefox")>0) { // Firefox 
    url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0)); 
    } else if(navigator.userAgent.indexOf("Chrome")>0) { // Chrome 
    url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0)); 
    } 
    return url; 
    } 

    /** 
    * 将本地图片 显示到浏览器上 
    */ 
    function preImg(sourceId, targetId) { 
    var url = getFileUrl(sourceId); 
    var imgPre = document.getElementById(targetId); 
    imgPre.src = url; 
    } 

</script>
    <script type="text/javascript" src="../../js/zepto.min.js"></script>
    <script type="text/javascript" src="../../js/config.php"></script>
    <script type="text/javascript" src="../../js/common.js"></script>
    <script type="text/javascript" src="../../js/simple-plugin.js"></script>
    <script type="text/javascript" src="../../js/tmpl/footer.js"></script>
    <script type="text/javascript" src="../../js/tmpl/bespeak_opera.js"></script>
</body>

</html>